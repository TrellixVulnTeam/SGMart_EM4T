<main style="width:auto;">
        <section>
            <h3 class="section-head">Overview</h3>
            <div class="analytics">
                <div class="analytic">
                    <div class="analytic-icon">
                        <span class="las la-eye"></span>
                    </div>
                    <div class="analytic-info">
                        <h4 style="">Total Users</h4>
                        <h3 id="users"></h3>
                    </div>
                </div>
                <div class="analytic">
                    <div class="analytic-icon">
                        <span class="las la-clock"></span>
                    </div>
                    <div class="analytic-info">
                        <h4>Total Orders</h4>
                        <h3 id="order"></h3>
                    </div>
                </div>
                <div class="analytic">
                    <div class="analytic-icon">
                        <span class="las la-users"></span>
                    </div>
                    <div class="analytic-info">
                        <h4>Total Revenue</h4>
                        <h3 id="rev"></h3>
                    </div>
                </div>
                <div class="analytic">
                    <div class="analytic-icon">
                        <span class="las la-heart"></span>
                    </div>
                    <div class="analytic-info">
                        <h4>Total Expenses</h4>
                        <h3 id="expense"></h4>
                    </div>
                </div>
            </div>
        </section>

    <section>
        <div class="block-grid">
            <div class="revenue-card">
                <h3 class="section-head">My Information</h3>
                <div class="rev-content">
                    {{#if user.password}}
                        {{#unless user.pfp}}
                        <img class="rounded-circle" height="50%" width="50%" src="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAkGBwgHBgkIBwgKCgkLDRYPDQwMDRsUFRAWIB0iIiAdHx8kKDQsJCYxJx8fLT0tMTU3Ojo6Iys/RD84QzQ5OjcBCgoKDQwNGg8PGjclHyU3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3N//AABEIAIAAgAMBIgACEQEDEQH/xAAbAAEAAwEBAQEAAAAAAAAAAAAAAwQFAQIHBv/EADQQAAICAAMECAQFBQAAAAAAAAECAAMEETEFIUFREhMiMlJhcYEzQmKSFBVDU8EjkaHR4f/EABQBAQAAAAAAAAAAAAAAAAAAAAD/xAAUEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwD7jERARPLsEUsxyA1MzcTjmclaT0V8XEwL12Jqp3M2beEaylZtB2P9NQo5nfKUQJGxFz961vY5TwSTqc/WciABI0OR8pKmIuTSxvcyKIFyvaLr8RQw5jcZdpxVV25WybkdZjR6QP0ETLw2OZMlt7S8+ImmrKyhlOYOhEDsREBPLsEUsxyA1M9TL2hiOk5qU9ldfMwIsViWvfkg0H+5BEQEREBET0tbt3UYjyEDzE9NW672RgPMGeYCIiAk+FxJw7c0OokEQN9WDKGU5gzsy9n4go/VMey2nkZqQIcXb1NJYancPWYsu7TsztVOCjMylAREQElw9DXtku4DU8p4rQ2OEXUnKbVNS1VhFG4f5gR04Sqod0M3MyxEQB3yvdhKrflCt4lliIGJfh3obJhu4EcZFNy6pbqyjjcePKYtiGt2RhvBygeYiICbOEu66kNxG4+sxpd2ZZlayHRhnArYluniLD9Rkc6TmSec5AREQLuy687Hc8BkPeaco7K7lnrL0BERAREQEzNqJlYrj5hkZpyjtXuV+pgZsREBJMM3QxFZ+oSOdU5MDyMDhGRI4iJLiV6GIsH1EyKAiIgXdmWBbWQ/MN3tNOYCMUcMuoOYm1h7lurDKfUcjAliIgIiICZm07OlaqD5RL2IuWiss2vAczMV2LuWY5knOByIiAnVGbAczOSXDL08RWPqBgWNp15Wq40YZH1lKbOMq66hlHe1ExoCIiAklNz0t0kO/iOcjAzOQ1kgouP6T/aYGlTjqrAA56Deen95ZDBhmpBHlMTqLv2n+0x1F37Vn2mBtlgozYgDzlW7HVV5hD028tJnGi461P8AaY/D3ftP9pgLrnufpOf+SOSGi4fpP9pkZ3HI7jAREQEu7MrztazgoyHrKU2cJT1NAU94729YE8y9oYfoP1qjstrlwM1JxlDKVYZg6iBgS3hMGbQHszVeA4mctw4w16mwFqc9x/gzURlZQVOYOkDldSVjJFAHlPcRAREQEREBPFlSWjJ1De09xAycXgzT20318eYlWb1hVUJfIKBvzmXThhiLm6vMU56n+IHrZ+H6b9Y47K6eZmpOKoRQqjIDQTsBERA8uqupVhmDqDKTU3YVi9HbTihl+IFejF1W7s+i3hMsSC7DVW72XteIayHqcVT8G0OvJ4F2JT/FXp8XDN6rH5hWO8jj2gXIlP8AMKz3Uc+0fir3+Fhm9WMC5K9+Krp3E5t4RIupxV3xbAi+FJNRhaqd6r2vEdYEAptxTBr+xWN4QS6qhFCqMgOE7EBERA//2Q==">
                        {{else}}
                        <img class="rounded-circle" height="50%" width="50%" src='/uploads/{{user.id}}/{{user.pfp}}'>
                        {{/unless}}
                    {{else}} 
                        <img class="rounded-circle" height="50%" width="50%" src="{{user.pfp}}">
                    {{/if}}
                    <div class="rev-info">
                        <h3>{{user.name}}</h3>
                        <h4>{{user.email}}</h4>
                    </div>
                    <div class="rev-sum">
                        <h4>Joined At</h4>
                        <h6 style="font-size: 10.72px;">{{user.createdAt}}</h4>
                    </div>
                </div>
            </div>
            <div class="graph-card">
                <h3 class="section-head">Graph</h3>
                <div class="graph-content">
                    <div class="graph-head">
                        <div class="icons-wrapper">
                            <h3>Profits</h3>
                        </div>
                        <div class="graph-select">
                            <select name="" id="time">
                                <option value="w">Last 7 Days</option>
                                <option value="m">Last 30 Days</option>
                            </select>
                        </div>
                    </div>
                    <div class="graph-board">
                        <canvas id="revenueChart" width="100%" height="51px"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </section>
    </main>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.bundle.js"></script>
<script>
    Chart.defaults.global.defaultFontFamily = "Poppins";
        let ctx = document.querySelector("#revenueChart");

        let revChart=new Chart(ctx, {
            type:"line",
            data:{
                labels:[],
                datasets:[
                    {
                        label:"Profits",
                        borderColor:"#396aff",
                        borderWidth:"3",
                        backgroundColor:"rgba(233,238,253,0.7)",
                        data:[]
                    }
                ]
            },
            options:{
                responsive: true,
                tooltips: {
                    intersect: false,
                    node: "index"
                }
            }
        });

    const time = document.getElementById('time')
    time.addEventListener('change', changedata)

    function changedata() {
        if (time.value == "w") {
            d = new Date();
            temp2 = []
            for (var i = 0; i < 7; i++) {
                ts = `${d.getDate()}/${d.getMonth()+1}`
                d.setDate(d.getDate()-1)
                temp2.push(ts)
            }
            temp = [90, 70, 85, 40, 20, 55, 60]
            revChart.data.labels = temp2.reverse();
            revChart.data.datasets[0].data = a;
            revChart.update()
        } else {
            d = new Date();
            temp2 = []
            for (var i = 0; i < 11; i++) {
                ts = `${d.getDate()}/${d.getMonth()+ 1}`
                d.setDate(d.getDate()-3)
                temp2.push(ts)
            }
            revChart.data.labels = temp2.reverse();
            temp = []
            revChart.data.datasets[0].data = b;
            revChart.update()
        }
    }
    function addData(chart, label, data) {
        chart.data.labels.push(label);
        chart.data.datasets.forEach((dataset) => {
            dataset.data.push(data);
        });
        chart.update();
    }
    a = []
    b = []
    $( document ).ready(function() {
      setTimeout(() => {
        $.getJSON('/admin/dashboardinfo', function (data) {
          $('#users').text(data.users.all.toString())
          temp = ((data.users.l30-data.users.l60)/data.users.l60*100)
          if (Math.abs(temp) !== Infinity) {
            if (temp < 0) {
                $('#users').append(' <small class="text-danger" id="usersstat"></small>');
                temp = temp * (-1)
            } else {
                $('#users').append(' <small class="text-success" id="usersstat"></small>');
            }
            $('#usersstat').text((temp).toString() + '%');
          }
          
          $('#usersstat').text(Math.round(temp,0).toString() + '%');

          $('#order').text(data.orders.all.toString())
          temp = ((data.orders.l30-data.users.l60)/data.orders.l60*100)
          if (temp < 0) {
            $('#order').append(' <small class="text-danger" id="orderstat"></small>');
            temp = temp * (-1)
          } else {
            $('#order').append(' <small class="text-success" id="orderstat"></small>');
          }
          $('#orderstat').text(Math.round(temp,0).toString() + '%');

          $('#rev').text('$' + data.revenue.all.toString())
          temp = ((data.revenue.l30-data.revenue.l60)/data.revenue.l60*100)
          if (temp < 0) {
            $('#rev').append(' <small class="text-danger" id="revstat"></small>');
            temp = temp * (-1)
          } else {
            $('#rev').append(' <small class="text-success" id="revstat"></small>');
          }
          $('#revstat').text(Math.round(temp,0).toString() + '%');

          $('#expense').text('$' + data.expense.all.toString())
          temp = ((data.expense.l30-data.expense.l60)/data.expense.l60*100)
          if (temp < 0) {
            $('#expense').append(' <small class="text-danger" id="expstat"></small>');
            temp = temp * (-1)
          } else {
            $('#expense').append(' <small class="text-success" id="expstat"></small>');
          }
          $('#expstat').text(Math.round(temp,0).toString() + '%');

          a = data.ginfo.l7
          b = data.ginfo.l30
        })
      },500),
      setTimeout(()=> {
        changedata()
        },1000)
    });
    
</script>

<style>
    header {
        background-color: white;
    }
</style>