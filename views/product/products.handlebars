<link rel="stylesheet" href="/css/product.css">

<div class="container" style="padding-top: 50px;">
  <div class="bg-white rounded d-flex align-items-center justify-content-between" id="header"> <button class="btn btn-hide text-uppercase" type="button" data-bs-toggle="collapse" data-bs-target="#filterbar" aria-expanded="false" aria-controls="filterbar" id="filter-btn" onclick="changeBtnTxt()"> <span class="fas fa-angle-left" id="filter-angle"></span> <span id="btn-txt">Hide filters</span> </button>
    <nav class="navbar navbar-expand-lg navbar-light ps-lg-0 ps-auto"> <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mynav" aria-controls="mynav" aria-expanded="false" aria-label="Toggle navigation" onclick="chnageIcon()" id="icon"> <span class="navbar-toggler-icon"></span> </button>
      <div class="collapse navbar-collapse" id="mynav">
        <ul class="navbar-nav d-lg-flex align-items-lg-center">
          <li class="nav-item active"> 
            <select name="sort" id="sort">
              <option value="" hidden selected>Sort by</option>
                <option value="price">Highest Price</option>
              <option value="price">Highest Price</option>
              <option value="popularity">Lowest Price</option>
              <option value="rating">Rating</option>
            </select> </li>
          <li class="nav-item d-lg-none d-inline-flex"> </li>
        </ul>
      </div>
    </nav>
    <div class="ms-auto mt-3 me-2">
      <nav aria-label="Page navigation example">
        <ul class="pagination">
          <li class="page-item"> <a class="page-link" href="#" aria-label="Previous"> <span aria-hidden="true" class="fw-bold">&lt;</span> <span class="visually-hidden">Previous</span> </a> </li>
          <li class="page-item active"><a class="page-link" href="#">1</a></li>
          <li class="page-item"><a class="page-link" href="#">..</a></li>
          <li class="page-item"><a class="page-link" href="#">10</a></li>
          <li class="page-item"> <a class="page-link" href="#" aria-label="Next"> <span aria-hidden="true" class="fw-bold">&gt;</span> <span class="visually-hidden">Next</span> </a> </li>
        </ul>
      </nav>
    </div>
  </div>
  <div id="content" class="my-5">
    <div id="filterbar" class="collapse">
     <div class="box border-bottom">
        <div class="form-group text-center">
          <div class="btn-group" data-toggle="buttons"> <label class="btn btn-success form-check-label"> <input class="form-check-input" type="radio"> Reset </label> <label class="btn btn-success form-check-label active"> <input class="form-check-input" type="radio" checked> Apply </label> </div>
        </div>
      </div>
      <div class="box border-bottom">
        <div class="box-label text-uppercase d-flex align-items-center">Categories <button class="btn ms-auto" type="button" data-bs-toggle="collapse" data-bs-target="#inner-box" aria-expanded="false" aria-controls="inner-box" id="out" onclick="outerFilter()"> <span class="fas fa-plus"></span> </button> </div>
        <div id="inner-box" class="collapse mt-2 me-1">
          <div class="my-1"> <label class="tick">Food & Pantry<input type="checkbox"> <span class="check"></span> </label> </div>
          <div class="my-1"> <label class="tick">Bakery, Cereal & Spreads <input type="checkbox"> <span class="check"></span> </label> </div>
          <div class="my-1"> <label class="tick">Dairy, Chilled & Frozen <input type="checkbox"> <span class="check"></span> </label> </div>
          <div class="my-1"> <label class="tick">Snacks & Drinks <input type="checkbox"> <span class="check"></span> </label> </div>
          <div class="my-1"> <label class="tick">Health & Beauty <input type="checkbox"> <span class="check"></span> </label> </div>
          <div class="my-1"> <label class="tick">Mum & Baby <input type="checkbox" > <span class="check"></span> </label> </div>
          <div class="my-1"> <label class="tick">Fruits & Vegetables<input type="checkbox"> <span class="check"></span> </label> </div>
          <div class="my-1"> <label class="tick">Household & Pets <input type="checkbox" > <span class="check"></span> </label> </div>
        </div>
      </div>

      <div class="box border-bottom">
        <div class="box-label text-uppercase d-flex align-items-center">Brands <button class="btn ms-auto" type="button" data-bs-toggle="collapse" data-bs-target="#inner-box2" aria-expanded="false" aria-controls="inner-box2"><span class="fas fa-plus"></span></button> </div>
        <div id="inner-box2" class="collapse mt-2 me-1">
          <div class="my-1"> <label class="tick">Meiji<input type="checkbox"> <span class="check"></span> </label> </div>
          <div class="my-1"> <label class="tick">Sunshine <input type="checkbox"> <span class="check"></span> </label> </div>
          <div class="my-1"> <label class="tick">Kleenex <input type="checkbox" > <span class="check"></span> </label> </div>
          <div class="my-1"> <label class="tick">Lay's <input type="checkbox"> <span class="check"></span> </label> </div>
          <div class="my-1"> <label class="tick">Heinz <input type="checkbox"> <span class="check"></span> </label> </div>
          <div class="my-1"> <label class="tick">Dettol <input type="checkbox"> <span class="check"></span> </label> </div>
          <div class="my-1"> <label class="tick">Huggies <input type="checkbox"> <span class="check"></span> </label> </div>
          <div class="my-1"> <label class="tick">Cold Storage<input type="checkbox"> <span class="check"></span> </label> </div>
        </div>
      </div>

      <div class="box border-bottom">
        <div class="box-label text-uppercase d-flex align-items-center">price <button class="btn ms-auto" type="button" data-bs-toggle="collapse" data-bs-target="#price" aria-expanded="false" aria-controls="price"><span class="fas fa-plus"></span></button> </div>
        <div class="collapse" id="price">
          <div class="middle">
            <div class="multi-range-slider"> <input type="range" id="input-left" min="0" max="100" value="10"> <input type="range" id="input-right" min="0" max="100" value="50">
              <div class="slider">
                <div class="track"></div>
                <div class="range"></div>
                <div class="thumb left"></div>
                <div class="thumb right"></div>
              </div>
            </div>
          </div>
          <div class="d-flex align-items-center justify-content-between mt-2">
            <div> <span id="amount-left" class="fw-bold"></span> SGD </div>
            <div> <span id="amount-right" class="fw-bold"></span> SGD </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div class = "products">
    <div class = "container">
        <div class = "product-items" style="">
            {{#product }}
            <div class = "product" style="width: 90%;">
                <div class = "product-content">
                    <div class = "product-img">
                        <a href="/product/details/{{id}}">
                            <img src = "/images/{{image}}" alt="{{product_name}}" alt = "product image">
                        </a>
                    </div>
                    <div class = "product-btns">

                        <a href="/product/details/{{id}}" class = "btn-buy" style="text-decoration: none; color:black; text-align:center;">
                          details<span><i class = "fas fa-shopping-cart"></i></span>
                        </a>
                      {{!-- {{#if product.stock > 0 }} --}}
                      <form action="/cart/add/{{id}}" method="post">
                          <input type="hidden" name="" value="">
                          <button type = "submit" class = "btn-cart" value="{{id}}"> add to cart
                              <span><i class = "fas fa-plus"></i></span>
                          </button>
                          <input type="hidden" name="quantity" value="1">
                      </form>
                      {{!-- {{# product.stock == 0 or product.stock < 0 }}
                          <button type="submit" disabled class="btn btn-danger float-end">Out of Stock</button>
                      {{/if }} --}}


                    </div>
                </div>

                <div class = "product-info">
                    <div class = "product-info-top">
                        <h2 class = "sm-title">Brand</h2>
                        <div class = "rating">
                            <span><i class = "fas fa-star"></i></span>
                            <span><i class = "fas fa-star"></i></span>
                            <span><i class = "fas fa-star"></i></span>
                            <span><i class = "fas fa-star"></i></span>
                            <span><i class = "far fa-star"></i></span>
                        </div>
                    </div>
                    <a href = "/product/details/{{id}}" class = "product-name">{{product_name}}</a>
                    <p class = "product-price">$ test</p>
                    <p class = "product-price">$ {{product_price}}</p>
                </div>
                <div class = "off-info">
                    <h2 class = "sm-title">{{discount}}% off</h2>
                </div>
            </div>
            {{/product}}
        </div>

        </div>
    </div>
</div>
<div class="row" style="padding: 30px;">
<div class="col text-center">
{{#if products.has_prev }}
    <a href=""class="btn mt-3 btn-outline-info">Previous</a>
{{/if }}
{{!-- {{ #if products.total > 8 }} --}}
{{!-- {{#each page_num in products.iter_pages(left_edge=1, right_edge=2, left_current=1, right_current=2) }}
{{ #if page_num }}
{{ #if products.page == page_num }}
<a href="" class="btn btn mt-3 btn-info">{{page_num}}</a>
{{#else }}
<a href="" class="btn btn mt-3 btn-outline-info">{{page_num}}</a>
{{/if }} --}}
{{!-- {{#else }}
...
{{/if }} --}}
{{!-- {{/if }}
{{ #if products.has_next }}
<a href="{{url_for('home', page=products.next_num)}}"class="btn  mt-3 btn-outline-info">Next</a>
{{/if }} --}}
</div>

<script>
document.addEventListener("DOMContentLoaded", function () {
  var inputLeft = document.getElementById("input-left");
  var inputRight = document.getElementById("input-right");

  var thumbLeft = document.querySelector(".slider > .thumb.left");
  var thumbRight = document.querySelector(".slider > .thumb.right");
  var range = document.querySelector(".slider > .range");

  var amountLeft = document.getElementById("amount-left");
  var amountRight = document.getElementById("amount-right");

  function setLeftValue() {
    var _this = inputLeft,
      min = parseInt(_this.min),
      max = parseInt(_this.max);

    _this.value = Math.min(
      parseInt(_this.value),
      parseInt(inputRight.value) - 1
    );

    var percent = ((_this.value - min) / (max - min)) * 100;

    thumbLeft.style.left = percent + "%";
    range.style.left = percent + "%";
    amountLeft.innerText = parseInt(percent * 1);
  }
  setLeftValue();

  function setRightValue() {
    var _this = inputRight,
      min = parseInt(_this.min),
      max = parseInt(_this.max);

    _this.value = Math.max(
      parseInt(_this.value),
      parseInt(inputLeft.value) + 1
    );

    var percent = ((_this.value - min) / (max - min)) * 100;

    amountRight.innerText = parseInt(percent * 1);
    thumbRight.style.right = 100 - percent + "%";
    range.style.right = 100 - percent + "%";
  }
  setRightValue();

  inputLeft.addEventListener("input", setLeftValue);
  inputRight.addEventListener("input", setRightValue);

  inputLeft.addEventListener("mouseover", function () {
    thumbLeft.classList.add("hover");
  });
  inputLeft.addEventListener("mouseout", function () {
    thumbLeft.classList.remove("hover");
  });
  inputLeft.addEventListener("mousedown", function () {
    thumbLeft.classList.add("active");
  });
  inputLeft.addEventListener("mouseup", function () {
    thumbLeft.classList.remove("active");
  });

  inputRight.addEventListener("mouseover", function () {
    thumbRight.classList.add("hover");
  });
  inputRight.addEventListener("mouseout", function () {
    thumbRight.classList.remove("hover");
  });
  inputRight.addEventListener("mousedown", function () {
    thumbRight.classList.add("active");
  });
  inputRight.addEventListener("mouseup", function () {
    thumbRight.classList.remove("active");
  });
});

</script>